# This file describes the network interfaces available on your system
# and how to activate them. For more information, see interfaces(5).
source /etc/network/interfaces.d/*

# The loopback network interface
auto lo
iface lo inet loopback
allow-hotplug enp0s3
iface enp0s3 inet dhcp
        post-up iptables -t nat -A POSTROUTING -s 192.168.1.0/24 ! -d 192.168.0.0/16 -o enp0s3 -j MASQUERADE
        post-up iptables -t nat -A POSTROUTING -s 192.168.2.0/24 ! -d 192.168.0.0/16 -o enp0s3 -j MASQUERADE
        post-up iptables  -A FORWARD -s 192.168.1.0/24 ! -d 192.168.0.0/16 -j ACCEPT
        post-up iptables  -A FORWARD -s 192.168.2.0/24 ! -d 192.168.0.0/16 -j ACCEPT
        post-up iptables -I INPUT -s 192.168.1.0/24 -d 192.168.2.0/24 -j DROP
        post-up iptables -I INPUT -s 192.168.2.0/24 -d 192.168.1.0/24 -j DROP
        post-up echo 1 > /proc/sys/net/ipv4/ip_forward
        post-down echo 0 > /proc/sys/net/ipv4/ip_forward
        post-down iptables -t nat -F
        post-down iptables -F

allow-hotplug  enp0s8
iface enp0s8 inet static
        address 192.168.1.1/24

allow-hotplug  enp0s9
iface enp0s9 inet static
        address 192.168.2.1/24
allow-hotplug enp0s10
iface enp0s10 inet dhcp